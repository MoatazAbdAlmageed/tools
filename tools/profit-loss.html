<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø±Ø©</title>
<link rel="stylesheet" href="../theme.css">
<style>
.profit-meter {
  height: 12px;
  background: var(--card);
  border-radius: 30px;
  overflow: hidden;
  margin: 16px 0;
  border: 1px solid var(--border);
}
.profit-bar {
  height: 100%;
  border-radius: 30px;
  transition: width 0.5s cubic-bezier(0.34,1.56,0.64,1), background 0.3s;
  background: linear-gradient(90deg, var(--success), #20c97a);
}
.profit-bar.loss { background: linear-gradient(90deg, var(--danger), #ff6b6b); }
.profit-bar.low { background: linear-gradient(90deg, var(--accent), #ffcc44); }

.result-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 20px;
}

.stat-box {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 16px;
  text-align: center;
  transition: border-color 0.3s;
}
.stat-box.green { border-color: var(--success); }
.stat-box.red   { border-color: var(--danger); }
.stat-box.orange { border-color: var(--accent); }

.stat-label { color: var(--muted); font-size: 0.78rem; font-weight: 700; margin-bottom: 6px; }
.stat-value { font-size: 1.5rem; font-weight: 900; }
.stat-value.green { color: var(--success); }
.stat-value.red   { color: var(--danger); }
.stat-value.orange { color: var(--accent); }

.verdict {
  text-align: center;
  padding: 18px;
  border-radius: var(--radius);
  font-size: 1.2rem;
  font-weight: 900;
  margin-top: 20px;
  transition: all 0.3s;
  display: none;
}
.verdict.profit { background: rgba(45,206,137,0.12); border: 1px solid var(--success); color: var(--success); display: block; }
.verdict.loss   { background: rgba(245,54,54,0.12); border: 1px solid var(--danger); color: var(--danger); display: block; }
.verdict.even   { background: rgba(245,166,35,0.12); border: 1px solid var(--accent); color: var(--accent); display: block; }
</style>
</head>
<body>
<div class="wrapper">
  <a href="../index.html" class="back-btn">â† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>

  <div class="page-header">
    <span class="page-icon">ğŸ“ˆ</span>
    <div class="page-title">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø±Ø©</div>
    <div class="page-desc">Ø§Ø¹Ø±Ù Ù‡Ø§Ù…Ø´ Ø±Ø¨Ø­Ùƒ Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ù†ØªØ¬</div>
  </div>

  <div class="card">
    <div class="input-group">
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input type="text" id="productName" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø±Ø²ØŒ Ø²ÙŠØª...">
    </div>

    <div class="input-group">
      <label>Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ (Ø§Ù„ØªÙƒÙ„ÙØ©)</label>
      <input type="number" id="cost" placeholder="0" min="0" step="any" oninput="calc()">
    </div>

    <div class="input-group">
      <label>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</label>
      <input type="number" id="sell" placeholder="0" min="0" step="any" oninput="calc()">
    </div>

    <div class="input-group">
      <label>Ø§Ù„ÙƒÙ…ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input type="number" id="qty" placeholder="1" min="1" step="1" oninput="calc()">
    </div>

    <div class="profit-meter"><div class="profit-bar" id="bar" style="width:0%"></div></div>

    <div class="result-grid">
      <div class="stat-box" id="profitBox">
        <div class="stat-label">Ø§Ù„Ø±Ø¨Ø­ / Ø§Ù„ÙˆØ­Ø¯Ø©</div>
        <div class="stat-value" id="profitVal">â€”</div>
      </div>
      <div class="stat-box" id="marginBox">
        <div class="stat-label">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ %</div>
        <div class="stat-value" id="marginVal">â€”</div>
      </div>
      <div class="stat-box" id="totalBox">
        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
        <div class="stat-value" id="totalVal">â€”</div>
      </div>
      <div class="stat-box" id="roiBox">
        <div class="stat-label">Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªÙƒÙ„ÙØ©</div>
        <div class="stat-value" id="roiVal">â€”</div>
      </div>
    </div>

    <div class="verdict" id="verdict"></div>

    <div class="btn-row">
      <button class="btn btn-secondary" onclick="clearAll()">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
      <button class="btn btn-primary" onclick="copyAll()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
function r(v, d=2) { return Math.round(v * Math.pow(10,d)) / Math.pow(10,d); }

function calc() {
  const cost = parseFloat(document.getElementById('cost').value);
  const sell = parseFloat(document.getElementById('sell').value);
  const qty  = parseFloat(document.getElementById('qty').value) || 1;

  if (isNaN(cost) || isNaN(sell) || cost <= 0 || sell <= 0) {
    ['profitBox','marginBox','totalBox','roiBox'].forEach(id => {
      document.getElementById(id).className = 'stat-box';
    });
    ['profitVal','marginVal','totalVal','roiVal'].forEach(id => document.getElementById(id).textContent = 'â€”');
    document.getElementById('bar').style.width = '0%';
    document.getElementById('verdict').className = 'verdict';
    return;
  }

  const profit = r(sell - cost);
  const margin = r((profit / sell) * 100);
  const roi    = r((profit / cost) * 100);
  const total  = r(profit * qty);

  const isProfit = profit > 0;
  const isLoss   = profit < 0;
  const cl = isProfit ? 'green' : isLoss ? 'red' : 'orange';

  document.getElementById('profitVal').textContent = profit;
  document.getElementById('profitVal').className = `stat-value ${cl}`;
  document.getElementById('profitBox').className = `stat-box ${cl}`;

  document.getElementById('marginVal').textContent = margin + '%';
  document.getElementById('marginVal').className = `stat-value ${cl}`;
  document.getElementById('marginBox').className = `stat-box ${cl}`;

  document.getElementById('totalVal').textContent = total;
  document.getElementById('totalVal').className = `stat-value ${cl}`;
  document.getElementById('totalBox').className = `stat-box ${cl}`;

  document.getElementById('roiVal').textContent = roi + '%';
  document.getElementById('roiVal').className = `stat-value ${cl}`;
  document.getElementById('roiBox').className = `stat-box ${cl}`;

  const bar = document.getElementById('bar');
  const pct = Math.min(Math.abs(margin), 100);
  bar.style.width = pct + '%';
  bar.className = `profit-bar ${isLoss ? 'loss' : margin < 15 ? 'low' : ''}`;

  const v = document.getElementById('verdict');
  if (isProfit) {
    v.textContent = margin >= 20 ? `ğŸ‰ Ø±Ø¨Ø­ Ù…Ù…ØªØ§Ø²! Ù‡Ø§Ù…Ø´ ${margin}%` : margin >= 10 ? `âœ… Ø±Ø¨Ø­ Ø¬ÙŠØ¯ ${margin}%` : `âš ï¸ Ø±Ø¨Ø­ Ù…Ù†Ø®ÙØ¶ ${margin}%`;
    v.className = 'verdict profit';
  } else if (isLoss) {
    v.textContent = `âŒ Ø®Ø³Ø§Ø±Ø©! Ø£Ù†Øª ØªØ®Ø³Ø± ${Math.abs(profit)} ÙÙŠ ÙƒÙ„ ÙˆØ­Ø¯Ø©`;
    v.className = 'verdict loss';
  } else {
    v.textContent = 'â– ØªØ¹Ø§Ø¯Ù„ - Ù„Ø§ Ø±Ø¨Ø­ ÙˆÙ„Ø§ Ø®Ø³Ø§Ø±Ø©';
    v.className = 'verdict even';
  }
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

function copyAll() {
  const cost = document.getElementById('cost').value;
  const sell = document.getElementById('sell').value;
  const name = document.getElementById('productName').value || 'Ø§Ù„Ù…Ù†ØªØ¬';
  const profit = document.getElementById('profitVal').textContent;
  const margin = document.getElementById('marginVal').textContent;
  const total  = document.getElementById('totalVal').textContent;

  if (!cost || !sell) return;

  const text = `${name}:\nØªÙƒÙ„ÙØ©: ${cost} | Ø¨ÙŠØ¹: ${sell}\nØ±Ø¨Ø­/ÙˆØ­Ø¯Ø©: ${profit} | Ù‡Ø§Ù…Ø´: ${margin}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ: ${total}`;
  navigator.clipboard.writeText(text);
  showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†ØªØ§Ø¦Ø¬!');
}

function clearAll() {
  ['cost','sell','qty','productName'].forEach(id => document.getElementById(id).value = '');
  calc();
}
</script>
</body>
</html>
